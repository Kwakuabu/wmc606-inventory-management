name: ğŸ“ WMC 606 - Advanced CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '0 6 * * *'  # Daily security scans
  workflow_dispatch:      # Manual trigger

jobs:
  # ğŸ§ª STAGE 1: Comprehensive Testing
  test:
    name: ğŸ§ª Test Data Structures & Algorithms
    runs-on: ubuntu-latest
    strategy:
      matrix:
        java-version: [17]
        
  # ğŸ”’ STAGE 2: Security & Quality Analysis  
  security:
    name: ğŸ”’ Security & Quality Analysis
    needs: test
    
  # ğŸ—ï¸ STAGE 3: Build & Package
  build:
    name: ğŸ—ï¸ Build Spring Boot Application
    needs: [test, security]
    
  # ğŸš€ STAGE 4: Deploy to AWS
  deploy:
    name: ğŸš€ Deploy to Production
    needs: build
    if: github.ref == 'refs/heads/main'
    
  # âœ… STAGE 5: Post-Deployment Verification
  verify:
    name: âœ… Verify Deployment
    needs: deploy
    
  # ğŸ“Š STAGE 6: Monitoring & Reporting
  report:
    name: ğŸ“Š Generate Reports
    needs: verify
    if: always()
